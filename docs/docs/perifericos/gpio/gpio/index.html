<!DOCTYPE html>
<html lang="es" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.80.0" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Puertos de entrada/salida de propósito general. #  Cando pensamos en programar microcontroladores, lo que queremos es hacer que el mundo se mueva, controlar un motor, un relevador, una lampara, altavoz, etc. Para ello los microcontroladores cuentan con una serie de periféricos. A grandes rasgos un periférico puede definirse como: una interfaz que permite al microcontrolador comunicarse con el exterior, en esta entrada describiremos los puertos de entrada/salida de propósito general; GPIOx.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Puertos de entrada/salida de propósito general (GPIO)" />
<meta property="og:description" content="Puertos de entrada/salida de propósito general. #  Cando pensamos en programar microcontroladores, lo que queremos es hacer que el mundo se mueva, controlar un motor, un relevador, una lampara, altavoz, etc. Para ello los microcontroladores cuentan con una serie de periféricos. A grandes rasgos un periférico puede definirse como: una interfaz que permite al microcontrolador comunicarse con el exterior, en esta entrada describiremos los puertos de entrada/salida de propósito general; GPIOx." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://logys.github.io/eleckia/docs/perifericos/gpio/gpio/" />
<meta property="article:published_time" content="2019-06-13T19:18:09+00:00" />
<meta property="article:modified_time" content="2019-06-13T19:18:09+00:00" />
<title>Puertos de entrada/salida de propósito general (GPIO) | Blog sobre sistemas embebidos</title>
<link rel="manifest" href="/eleckia/manifest.json">
<link rel="icon" href="/eleckia/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/eleckia/book.min.e935e20bd0d469378cb482f0958edf258c731a4f895dccd55799c6fbc8043f23.css" integrity="sha256-6TXiC9DUaTeMtILwlY7fJYxzGk&#43;JXczVV5nG&#43;8gEPyM=">
<script defer src="/eleckia/es.search.min.9d1fb90ccf9accca364d1ffbfe93ee2412ca245239889d543dcccb366d1836de.js" integrity="sha256-nR&#43;5DM&#43;azMo2TR/7/pPuJBLKJFI5iJ1UPczLNm0YNt4="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/eleckia"><span>Blog sobre sistemas embebidos</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Buscar" aria-label="Buscar" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6f6f484549ce2d8602f7989616e2f29f" class="toggle"  />
    <label for="section-6f6f484549ce2d8602f7989616e2f29f" class="flex justify-between">
      <a href="https://logys.github.io/eleckia/docs/workstation/" class="">Estación de trabajo</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/workstation/arduino/" class="">Arduino</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/workstation/estacion-de-trabajo/" class="">Estación de trabajo</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c5a8f28f5516b1587793df786fc2352d" class="toggle"  />
    <label for="section-c5a8f28f5516b1587793df786fc2352d" class="flex justify-between">
      <a href="https://logys.github.io/eleckia/docs/avr/" class="">Programación Avr en C.</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/registros/" class="">Registros</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-arreglos/" class="">Programando Avr en C. Arreglos.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers-ii-apuntadores-dobles/" class="">Programando Avr en C.- Apuntadores, punteros, pointers III. Apuntadores Dobles.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers-ii-apuntadores-a-funciones/" class="">Programando Avr en C.- Apuntadores, punteros, pointers II. Apuntadores a funciones.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers/" class="">Programando Avr en C.- Apuntadores, punteros, pointers I.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-el-flujo-del-programa-if-else-if-else/" class="">Programando Avr en C.- El flujo del programa, if, else, if else.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-constantes/" class="">Programando Avr en C.- Constantes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-tipo-de-dato-booleano-operadores-booleanos-y-de-comparacion/" class="">Programando Avr en C.- Tipo de dato Booleano, operadores booleanos y de comparación.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/funciones/" class="">Funciones</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/primitivos/" class="">Variables y tipos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/iniciando/" class="">Programando Avr en C.- Blinky</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Perifericos</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-32e0e2a16668b9d33b9df31ea5765d8c" class="toggle" checked />
    <label for="section-32e0e2a16668b9d33b9df31ea5765d8c" class="flex justify-between">
      <a  class="">GPIO</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/perifericos/gpio/biblioteca7/" class="">Api Display Siete Segmentos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/perifericos/gpio/gpio/" class=" active">Puertos de entrada/salida de propósito general (GPIO)</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/eleckia/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Puertos de entrada/salida de propósito general (GPIO)</strong>

  <label for="toc-control">
    
    <img src="/eleckia/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#configurar-un-pin-como-salida">Configurar un Pin como Salida.</a>
      <ul>
        <li><a href="#establecer-el-estado-cuando-el-pin-es-configurado-como-salida">Establecer el estado cuando el pin es configurado como salida.</a></li>
        <li><a href="#toggle">Toggle</a></li>
      </ul>
    </li>
    <li><a href="#configurar-un-pin-como-entrada">Configurar un Pin como Entrada.</a>
      <ul>
        <li><a href="#resistencia-de-pull-up">Resistencia de Pull up.</a></li>
        <li><a href="#leer-el-estado-de-un-pin">Leer el estado de un pin.</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="puertos-de-entradasalida-de-propósito-general">
  Puertos de entrada/salida de propósito general.
  <a class="anchor" href="#puertos-de-entradasalida-de-prop%c3%b3sito-general">#</a>
</h1>
<p>Cando pensamos en programar microcontroladores, lo que queremos es hacer que el
mundo se mueva, controlar un motor, un relevador, una lampara, altavoz, etc.
Para ello los microcontroladores cuentan con una serie de periféricos.
A grandes rasgos un periférico puede definirse como: una interfaz que permite
al microcontrolador comunicarse con el exterior, en esta entrada describiremos
los puertos de entrada/salida de propósito general; GPIOx.</p>
<p>Según la hoja de datos el atmega328p tiene hasta 23 pines programables, cada
uno con la posibilidad de ser programado individualmente, Arduino Uno tiene 20
pines disponibles, pues 2 están destinados al reloj y el otro está destinado al
pin de reset.</p>
<p>Los pines están agrupados en puertos, en el atmega328 contamos con tres puertos
disponibles, PORTB, PORTC, PORTD, de manera genérica los llamamos PORTx,  cada
uno de estos puertos cuentan con tres registros asociados, DDRx, PORTx, PINx,
donde &ldquo;x&rdquo; es el puerto(B, C, D), estos nueve registros nos permiten configurar
y acceder a los valores de cada uno de los pines del microcontrolador.</p>
<p>Los pines en el microcontrolador tienen un nombre del tipo Pxn, donde x es el
puerto y n es él número de pin, el pin PB0 y el pin PD7, son el pin 0 y el pin 7
del puerto B y del puerto D respectivamente.</p>
<h2 id="configurar-un-pin-como-salida">
  Configurar un Pin como Salida.
  <a class="anchor" href="#configurar-un-pin-como-salida">#</a>
</h2>
<p>La primera necesidad que se resuelve al programar un microcontrolador es
encender y apagar un dispositivo externo, todos los pines que corresponden a
alguno de los puertos gpio pueden establecerse como salidas, establecer un pin
como salida implica dotar a ese pin de la capacidad de entregar o recibir
corriente eléctrica, cada unos de los pines del atmega328p puede entregar un
máximo de 20[mA] y un total de 200[mA] entre todos, esto es bastante aunque
no lo parezca, la mayoría de las veces tomaremos alrededor de 1[mA] de cada
pin o menos, el objetivo de un microcontrolador es controlar, no dotar de
potencia a los dispositivos, cuando se requiere más potencia como para manejar
un motor grande, se recurre a electronica adicional dedicada a ese rubro.</p>
<p>Suponiendo que requerimos encender un led (un led requiere alrededor de 10[mA])
que está conectado al pin PB4,
Debemos indicarle al registro DDRB que requerimos el pin PB4 como salida:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB4;
</code></pre></div><p><a href="../../../avr/registros">Para mayores detalles sobre como establecer un bit</a></p>
<h3 id="establecer-el-estado-cuando-el-pin-es-configurado-como-salida">
  Establecer el estado cuando el pin es configurado como salida.
  <a class="anchor" href="#establecer-el-estado-cuando-el-pin-es-configurado-como-salida">#</a>
</h3>
<p>Cuando un pin es configurado como salida, puede entregar/recibir potencia,
poquita, pero suficiente para mover al mundo, para ello se requiere establecer
el estado del pin, asumiendo que tenemos conectado un led al pin PB4 y que dicho
pin esta configurado como salida en el registro DDRB, entonces podemos
establecer el estado del pin en el registro <strong>PORTB</strong>, donde un cero es nivel
bajo(0 V) y un uno es nivel alto (5 V).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">//Led encendido
</span><span style="color:#75715e"></span>PORTB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB4;
<span style="color:#75715e">//Led apagado 
</span><span style="color:#75715e"></span>PORTB <span style="color:#f92672">&amp;=</span> <span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB4);
</code></pre></div><h3 id="toggle">
  Toggle
  <a class="anchor" href="#toggle">#</a>
</h3>
<p>Algo muy curioso es que sin un pin esta configurado como salida y se escribe
al registro correspondiente de entrada, el pin hace un toggle o un xor,
suponiendo que el pin PD1 se encuentre configurado como salida:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">PINB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PD1; <span style="color:#75715e">//El pin se pone en estado alto si estaba en bajo
</span><span style="color:#75715e"></span>PINB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PD1; <span style="color:#75715e">//El pin se pone en estado bajo si estaba en alto
</span></code></pre></div><p>Este es un comportamiento típico y raro pero útil de los avr de 8 bits.</p>
<h2 id="configurar-un-pin-como-entrada">
  Configurar un Pin como Entrada.
  <a class="anchor" href="#configurar-un-pin-como-entrada">#</a>
</h2>
<p>Para poder hacer acciones más complejas requerimos que nuestro microcontrolador
pueda &ldquo;sentir&rdquo; al mundo, los pines de nuestro microcontrolador pueden
configurarse para que se pueda interpretar el estado de un pin, establecido por
un elemento externo (como un botón pulsador). Para ello también se utiliza el
registro DDRx, pero en esta ocasión el pin a ser configurado se establece con
un cero.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRC <span style="color:#f92672">&amp;=</span> <span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC0); <span style="color:#75715e">//Pin PC0 como entrada
</span></code></pre></div><p>Establecer un pin como entrada implica que el pin es incapaz de recibir y
entregar corriente, esto es muy bueno pues el dispositivo que esta enviando
los pulsos requiere un gasto de energía mínimo, por otro lado el pin
se vuelve extremadamente sensible a cualquier impulso incluso a las ondas
electromagnéticas generadas por diferentes fuentes, como lamparas o televisores.
Se dice que el pin del microcontrolador esta configurado en modo de alta
impedancia. La mayoría de los microcontroladores cuentan con una resistencia
de pull up que resuelve este problema.</p>
<h3 id="resistencia-de-pull-up">
  Resistencia de Pull up.
  <a class="anchor" href="#resistencia-de-pull-up">#</a>
</h3>
<p>Para evitar que el pin configurado como entrada se vuelva loco con solo mirarlo,
basta con habilitar una resistencia de pull up en el pin, la resistencia se puede
poner de forma externa o habilitar la resistencia interna que el microcontrolador
trae para este propósito, la resistencia de pull up no es más que una resistencia
conectada entre el pin y Vcc(5[V] en condiciones normales), de tal forma que
el pin se &ldquo;ancla&rdquo; al voltaje de Vcc. La resistencia de pull up tiene un valor
grande no se requiere de mucha potencia para &ldquo;desanclar&rdquo; el pin de Vcc por parte
del dispositivo que envía la señal.</p>
<p>Para habilitar la resistencia interna de pull up, asumiendo que el pin PC0
se encuentra configurado como entrada:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">PORTC <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC0; <span style="color:#75715e">//PC0 con resistencia de pullUp
</span></code></pre></div><p>Desafortunadamente el atmega328p no cuenta con resistencia de pull down.</p>
<h3 id="leer-el-estado-de-un-pin">
  Leer el estado de un pin.
  <a class="anchor" href="#leer-el-estado-de-un-pin">#</a>
</h3>
<p>Cuando requerimos leer el estado del pin, utilizamos el registro <strong>PINx</strong>,
contiene el estado de cada unos de los pines del puerto,
Para censar al pin, debemos configurarlo como entrada en el registro DDRx.</p>
<p>Para
leer el estado del pin PC3, asumiendo que PC3 esta conectado a 5V y que PC3
esta configurado como entrada en DDRC (con un cero),</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">uint8_t entrada <span style="color:#f92672">=</span> PINC <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC3);
<span style="color:#75715e">//Es igual a
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>bxxxx1xxx <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span>b00001000;
<span style="color:#75715e">//donde las x pueden ser 0 o 1
</span><span style="color:#75715e">//aplicando and bit a bit resulta en
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00001000;
<span style="color:#75715e">//entrada es exactamente igual a
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
<span style="color:#75715e">//si PC0 estuvera conectado a tierra, 
</span><span style="color:#75715e">//entrada resultaría en
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>bxxxx0xxx <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span>b00001000;
<span style="color:#75715e">//aplicando and bit a bit resulta en
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>b00000000;
<span style="color:#75715e">//o
</span><span style="color:#75715e"></span>entrada <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#configurar-un-pin-como-salida">Configurar un Pin como Salida.</a>
      <ul>
        <li><a href="#establecer-el-estado-cuando-el-pin-es-configurado-como-salida">Establecer el estado cuando el pin es configurado como salida.</a></li>
        <li><a href="#toggle">Toggle</a></li>
      </ul>
    </li>
    <li><a href="#configurar-un-pin-como-entrada">Configurar un Pin como Entrada.</a>
      <ul>
        <li><a href="#resistencia-de-pull-up">Resistencia de Pull up.</a></li>
        <li><a href="#leer-el-estado-de-un-pin">Leer el estado de un pin.</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












