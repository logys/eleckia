<!DOCTYPE html>
<html lang="es" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.80.0" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Registros y Acceso #  Registros #  ¿Qué son los registros?, un registro es un espacio en memoria que guarda información, tan simple como eso. En el mundo de los microcontroladores un registro guarda la información que define el comportamiento del microcontrolador.
Cada periférico cuenta con varios registros, listos para ser modificados y leídos para adaptarlos a la solución de un problema en particular.
En la arquitectura avr de 8 bits, los registros son de 8 bits, algunos registros se presentan como de 16 bits, pero en realidad son 2 registros de 8 bits, el tamaño lo indica el bus de datos que en avr es de 8 bits, en otras arquitecturas donde el bus es más grande los registros son de otros tamaños.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Registros" />
<meta property="og:description" content="Registros y Acceso #  Registros #  ¿Qué son los registros?, un registro es un espacio en memoria que guarda información, tan simple como eso. En el mundo de los microcontroladores un registro guarda la información que define el comportamiento del microcontrolador.
Cada periférico cuenta con varios registros, listos para ser modificados y leídos para adaptarlos a la solución de un problema en particular.
En la arquitectura avr de 8 bits, los registros son de 8 bits, algunos registros se presentan como de 16 bits, pero en realidad son 2 registros de 8 bits, el tamaño lo indica el bus de datos que en avr es de 8 bits, en otras arquitecturas donde el bus es más grande los registros son de otros tamaños." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://logys.github.io/eleckia/docs/avr/registros/" />
<meta property="article:published_time" content="2021-12-25T11:04:48-06:00" />
<meta property="article:modified_time" content="2021-12-25T11:04:48-06:00" />
<title>Registros | Blog sobre sistemas embebidos</title>
<link rel="manifest" href="/eleckia/manifest.json">
<link rel="icon" href="/eleckia/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/eleckia/book.min.e935e20bd0d469378cb482f0958edf258c731a4f895dccd55799c6fbc8043f23.css" integrity="sha256-6TXiC9DUaTeMtILwlY7fJYxzGk&#43;JXczVV5nG&#43;8gEPyM=">
<script defer src="/eleckia/es.search.min.9d1fb90ccf9accca364d1ffbfe93ee2412ca245239889d543dcccb366d1836de.js" integrity="sha256-nR&#43;5DM&#43;azMo2TR/7/pPuJBLKJFI5iJ1UPczLNm0YNt4="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/eleckia"><span>Blog sobre sistemas embebidos</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Buscar" aria-label="Buscar" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6f6f484549ce2d8602f7989616e2f29f" class="toggle"  />
    <label for="section-6f6f484549ce2d8602f7989616e2f29f" class="flex justify-between">
      <a href="https://logys.github.io/eleckia/docs/workstation/" class="">Estación de trabajo</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/workstation/arduino/" class="">Arduino</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/workstation/estacion-de-trabajo/" class="">Estación de trabajo</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c5a8f28f5516b1587793df786fc2352d" class="toggle" checked />
    <label for="section-c5a8f28f5516b1587793df786fc2352d" class="flex justify-between">
      <a href="https://logys.github.io/eleckia/docs/avr/" class="">Programación Avr en C.</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/registros/" class=" active">Registros</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-arreglos/" class="">Programando Avr en C. Arreglos.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers-ii-apuntadores-dobles/" class="">Programando Avr en C.- Apuntadores, punteros, pointers III. Apuntadores Dobles.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers-ii-apuntadores-a-funciones/" class="">Programando Avr en C.- Apuntadores, punteros, pointers II. Apuntadores a funciones.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-apuntadores-punteros-pointers/" class="">Programando Avr en C.- Apuntadores, punteros, pointers I.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-el-flujo-del-programa-if-else-if-else/" class="">Programando Avr en C.- El flujo del programa, if, else, if else.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-constantes/" class="">Programando Avr en C.- Constantes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/programando-avr-en-c-tipo-de-dato-booleano-operadores-booleanos-y-de-comparacion/" class="">Programando Avr en C.- Tipo de dato Booleano, operadores booleanos y de comparación.</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/funciones/" class="">Funciones</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/primitivos/" class="">Variables y tipos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/avr/iniciando/" class="">Programando Avr en C.- Blinky</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Perifericos</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-32e0e2a16668b9d33b9df31ea5765d8c" class="toggle"  />
    <label for="section-32e0e2a16668b9d33b9df31ea5765d8c" class="flex justify-between">
      <a  class="">GPIO</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/perifericos/gpio/biblioteca7/" class="">Api Display Siete Segmentos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://logys.github.io/eleckia/docs/perifericos/gpio/gpio/" class="">Puertos de entrada/salida de propósito general (GPIO)</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/eleckia/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Registros</strong>

  <label for="toc-control">
    
    <img src="/eleckia/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#registros">Registros</a></li>
    <li><a href="#acceso">Acceso</a>
      <ul>
        <li><a href="#bitwise-corrimiento-a-la-izquierda">bitwise Corrimiento a la izquierda</a></li>
        <li><a href="#establecer-un-bit">Establecer un bit</a></li>
        <li><a href="#limpiar-un-bit">Limpiar un bit</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="registros-y-acceso">
  Registros y Acceso
  <a class="anchor" href="#registros-y-acceso">#</a>
</h1>
<h2 id="registros">
  Registros
  <a class="anchor" href="#registros">#</a>
</h2>
<p>¿Qué son los registros?, <em>un registro es un espacio en memoria que guarda
información</em>, tan simple como eso. En el mundo de los microcontroladores
un registro guarda la información que define el comportamiento del
microcontrolador.</p>
<p>Cada periférico cuenta con varios registros, listos para ser modificados y
leídos para adaptarlos a la solución de un problema en particular.</p>
<p>En la arquitectura avr de 8 bits, los registros son de 8 bits, algunos
registros se presentan como de 16 bits, pero en realidad son 2 registros
de 8 bits, el tamaño lo indica el bus de datos que en avr es de 8 bits,
en otras arquitecturas donde el bus es
más grande los registros son de otros tamaños.</p>
<p>La programación de sistemas embebidos mucho tiene que ver con modificar
registros, esta es la principal diferencia aunque no la única con respecto a
programa en software de alto nivel.</p>
<h2 id="acceso">
  Acceso
  <a class="anchor" href="#acceso">#</a>
</h2>
<p>Entendido lo que es un registro, veamos como modificarlo.</p>
<p>Ya hemos utilizado registros, por ejemplo <em>DDRB</em>, data direction register del
puerto B, establece a los pines como entrada o salida:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">//Establece el pin 5 del puerto B como salida y el resto como entradas
</span><span style="color:#75715e"></span>DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00100000;
</code></pre></div><p>sin embargo la sintaxis <em>0bxxxx</em> no es estándar, únicamente esta disponible
via avr-libc, que es la biblioteca principal utilizada por avr-gcc, lo que
implica que nuestro código no sea portable si usamos esta sintaxis.</p>
<p>Otra forma de abordar la asignación es por medio de la notación hexadecimal,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">//0b0010 0000;
</span><span style="color:#75715e">//  2    0	
</span><span style="color:#75715e"></span>DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x20</span>;
</code></pre></div><p>El número binario se divide en dos cuartetos y cada uno representa un
número en hexadecimal, esto es cierto debido a las propiedades de las
bases binarias y hexadecimal, es una forma estandarizada de asignación
y es ampliamente utilizada, operaciones con datos de 8 bits son fáciles
pero cuando los registros son de 32 bits por ejemplo, las conversiones
son más complicadas y se suelen cometer errores, existe otra forma de
abordar el problema</p>
<h3 id="bitwise-corrimiento-a-la-izquierda">
  bitwise Corrimiento a la izquierda
  <a class="anchor" href="#bitwise-corrimiento-a-la-izquierda">#</a>
</h3>
<p>El operador <strong>&laquo;</strong> corrimiento a la izquierda es un gran aliado para
resolver este problema:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">//0b0010 0000;
</span><span style="color:#75715e"></span>DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">5</span>;
</code></pre></div><p>Recorre el número a la izquierda del operador el número de veces indicado a
la derecha del operador, en este caso recorre el número 1, 5 veces a la izquierda,
el corrimiento se hace en la forma binaria del número a la izquierda:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">1</span>;
<span style="color:#75715e">//Daria como resultado 0b110 (6 en decimal) no 30 en decimal
</span><span style="color:#75715e"></span>
DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB5; <span style="color:#75715e">//Lo que nos intersa es que el 1 quede en la posición PB5
</span></code></pre></div><p>Sin embargo el problema de modificar el resto de pines del registro persiste,
veamos la solución a este problema.</p>
<h3 id="establecer-un-bit">
  Establecer un bit
  <a class="anchor" href="#establecer-un-bit">#</a>
</h3>
<p>El operado binario or <strong>|</strong> es perfecto para solucionar el problema,
el operador |, opera en dos números binarios con la regla:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash"><span style="color:#ae81ff">0</span> or 0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> or 0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> or 1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> or 1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><p>Por ejemplo, para los números binarios, 100 y 010, el resultado de hacer un or
bit a bit es</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">bit2 bit1 bit0
   <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>
   or   or   or
   <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">0</span>
--------------
   <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">0</span>  Resultado
</code></pre></div><p>Asumiendo que el registro DDRB contiene el valor 0000 0111, es decir los 3
primeros bits están configurados como salidas, requerimos hacer que el bit
correspondiente a PB5 sea 1, sin modificar el resto, para ello usamos la
sintaxis,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRB <span style="color:#f92672">=</span> DDRB <span style="color:#f92672">|</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB5);
<span style="color:#75715e">//Es igual a 
</span><span style="color:#75715e"></span>DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00000111 <span style="color:#f92672">|</span> <span style="color:#ae81ff">0</span>b00100000;
<span style="color:#75715e">//despues de hacer or, resulta
</span><span style="color:#75715e"></span>DDRB <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00100111;
<span style="color:#75715e">//DDRB queda con el bit PB5 en 1 y el resto sin modificar
</span></code></pre></div><p>Una notación más compacta y equivalente es:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB5;
</code></pre></div><p>También es posible encadenar varios pines:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRB <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB5 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB0 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PB3;
</code></pre></div><h3 id="limpiar-un-bit">
  Limpiar un bit
  <a class="anchor" href="#limpiar-un-bit">#</a>
</h3>
<p>Con limpiar un bit me refiero a ponerlo en cero, para ello el operador
binario and <strong>&amp;</strong> es el indicado, el operado &amp; opera con dos números
binarios con la regla:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">0</span> and 0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">0</span> and 1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> and 0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> and 1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><p>Por ejemplo en los siguientes números binarios el resultado es,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bit2 bit1 bit0
   <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>
       and
   <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">1</span>    <span style="color:#ae81ff">0</span>
-------------- 
   <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span> Resultado
</code></pre></div><p>Otro operador (en este caso unario) importante es el complemento a uno <strong>~</strong>,
cambia el valor de 1 a 0 y de 0 a 1, por ejemplo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash"><span style="color:#ae81ff">1010</span>
  ~
-----
<span style="color:#ae81ff">0101</span> Resultado
</code></pre></div><p>Asumiendo que el registro DDRC contiene el número 0b0010 0011, requerimos
configurar el pin PC0 como entrada, asignar DDRC = 0 no es aceptable (colocaría
todos los pines como entrada), en su lugar usaremos el siguiente código</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRC <span style="color:#f92672">=</span> DDRC <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC0);
<span style="color:#75715e">//Primero se realiza (1&lt;&lt;PC0), resulta
</span><span style="color:#75715e"></span>DDRC <span style="color:#f92672">=</span> DDRC <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span><span style="color:#ae81ff">0</span>b00000001;
<span style="color:#75715e">//Ahora se aplica el operador complemento, resulta
</span><span style="color:#75715e"></span>DDRC <span style="color:#f92672">=</span> DDRC <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span>b11111110;
<span style="color:#75715e">//Operador And bit a bit,
</span><span style="color:#75715e"></span>DDRC <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00100011 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span>b11111110;
<span style="color:#75715e">//Resulta
</span><span style="color:#75715e"></span>DDRC <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b00100010;
</code></pre></div><p>De esta forma logramos establecer el pin requerido sin afectar el resto. Por
supuesto también se pueden limpiar varios pines:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">DDRC <span style="color:#f92672">&amp;=</span> <span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC0 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC1 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>PC5);
</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#registros">Registros</a></li>
    <li><a href="#acceso">Acceso</a>
      <ul>
        <li><a href="#bitwise-corrimiento-a-la-izquierda">bitwise Corrimiento a la izquierda</a></li>
        <li><a href="#establecer-un-bit">Establecer un bit</a></li>
        <li><a href="#limpiar-un-bit">Limpiar un bit</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












